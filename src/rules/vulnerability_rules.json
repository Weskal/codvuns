[
  {
    "id": "SQL_INJECTION_001",
    "name": "SQL Injection - String Concatenation",
    "description": "Detecta potencial SQL injection através de concatenação de strings em queries",
    "severity": "HIGH",
    "category": "injection",
    "rule_type": "regex",
    "patterns": [
      "(?:SELECT|INSERT|UPDATE|DELETE).*\\+.*(?:WHERE|VALUES|SET)",
      "cursor\\.execute\\s*\\(\\s*[\"'][^\"']*[\"']\\s*\\+",
      "\\.format\\s*\\([^)]*\\)\\s*(?:SELECT|INSERT|UPDATE|DELETE)",
      "f[\"'].*(?:SELECT|INSERT|UPDATE|DELETE).*\\{.*\\}.*[\"']"
    ],
    "target_languages": ["python"],
    "file_patterns": ["*.py"],
    "excluded_paths": ["test", "tests"],
    "case_sensitive": false,
    "multiline": false,
    "enabled": true,
    "confidence_threshold": 0.7,
    "metadata": {
      "cwe_id": "CWE-89",
      "owasp_category": "A03:2021 - Injection",
      "references": [
        "https://owasp.org/www-community/attacks/SQL_Injection",
        "https://cwe.mitre.org/data/definitions/89.html"
      ],
      "tags": ["sql", "injection", "database"],
      "author": "CODVUNS Team",
      "created_date": "2025-01-01",
      "last_updated": "2025-01-01"
    }
  },
  {
    "id": "XSS_001",
    "name": "Cross-Site Scripting (XSS)",
    "description": "Detecta potencial vulnerabilidade XSS em templates e outputs",
    "severity": "MEDIUM",
    "category": "xss",
    "rule_type": "regex",
    "patterns": [
      "innerHTML\\s*=\\s*.*\\+",
      "document\\.write\\s*\\(\\s*.*\\+",
      "\\.html\\(\\s*.*\\+",
      "render_template_string\\s*\\(",
      "\\|\\s*safe(?:\\s*\\}|$)"
    ],
    "target_languages": ["javascript", "python"],
    "file_patterns": ["*.js", "*.html", "*.py"],
    "excluded_paths": ["test", "tests"],
    "case_sensitive": false,
    "multiline": false,
    "enabled": true,
    "confidence_threshold": 0.6,
    "metadata": {
      "cwe_id": "CWE-79",
      "owasp_category": "A03:2021 - Injection",
      "references": [
        "https://owasp.org/www-community/attacks/xss/",
        "https://cwe.mitre.org/data/definitions/79.html"
      ],
      "tags": ["xss", "injection", "web"],
      "author": "CODVUNS Team",
      "created_date": "2025-01-01",
      "last_updated": "2025-01-01"
    }
  },
  {
    "id": "HARDCODED_SECRETS_001",
    "name": "Hardcoded Secrets",
    "description": "Detecta segredos hardcoded no código",
    "severity": "HIGH",
    "category": "hardcoded_secrets",
    "rule_type": "regex",
    "patterns": [
      "(?:password|pwd|passwd)\\s*=\\s*[\"'][^\"']{3,}[\"']",
      "(?:api_key|apikey|secret_key|secretkey)\\s*=\\s*[\"'][^\"']{10,}[\"']",
      "(?:token|auth_token|access_token)\\s*=\\s*[\"'][^\"']{10,}[\"']",
      "(?:private_key|privatekey)\\s*=\\s*[\"'][^\"']{20,}[\"']"
    ],
    "target_languages": ["python", "javascript", "java"],
    "file_patterns": ["*.py", "*.js", "*.java"],
    "excluded_paths": ["test", "tests"],
    "case_sensitive": false,
    "multiline": false,
    "enabled": true,
    "confidence_threshold": 0.8,
    "metadata": {
      "cwe_id": "CWE-798",
      "owasp_category": "A07:2021 - Identification and Authentication Failures",
      "references": [
        "https://cwe.mitre.org/data/definitions/798.html"
      ],
      "tags": ["secrets", "credentials", "authentication"],
      "author": "CODVUNS Team",
      "created_date": "2025-01-01",
      "last_updated": "2025-01-01"
    }
  },
  {
    "id": "DANGEROUS_FUNCTIONS_001",
    "name": "Dangerous Functions",
    "description": "Detecta uso de funções perigosas como eval() e exec()",
    "severity": "HIGH",
    "category": "dangerous_functions",
    "rule_type": "ast",
    "patterns": ["dangerous_functions"],
    "target_languages": ["python"],
    "file_patterns": ["*.py"],
    "excluded_paths": ["test", "tests"],
    "case_sensitive": true,
    "multiline": false,
    "enabled": true,
    "confidence_threshold": 0.9,
    "metadata": {
      "cwe_id": "CWE-95",
      "owasp_category": "A03:2021 - Injection",
      "references": [
        "https://cwe.mitre.org/data/definitions/95.html"
      ],
      "tags": ["eval", "exec", "code_injection"],
      "author": "CODVUNS Team",
      "created_date": "2025-01-01",
      "last_updated": "2025-01-01"
    }
  },
  {
    "id": "BROKEN_AUTH_001",
    "name": "Weak Password Validation",
    "description": "Detecta validação de senha fraca ou ausente",
    "severity": "MEDIUM",
    "category": "broken_authentication",
    "rule_type": "regex",
    "patterns": [
      "password.*=.*input",
      "if.*password.*==",
      "password.*length.*<.*[1-5]",
      "no.*password.*validation"
    ],
    "target_languages": ["python", "javascript"],
    "file_patterns": ["*.py", "*.js"],
    "excluded_paths": ["test", "tests"],
    "case_sensitive": false,
    "multiline": false,
    "enabled": true,
    "confidence_threshold": 0.6,
    "metadata": {
      "cwe_id": "CWE-521",
      "owasp_category": "A07:2021 - Identification and Authentication Failures",
      "references": [
        "https://cwe.mitre.org/data/definitions/521.html",
        "https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication"
      ],
      "tags": ["authentication", "password", "validation"],
      "author": "CODVUNS Team",
      "created_date": "2025-01-01",
      "last_updated": "2025-01-01"
    }
  },
  {
    "id": "SEC_MISCONFIG_001", 
    "name": "Debug Mode Enabled",
    "description": "Detecta modo debug habilitado em produção",
    "severity": "HIGH",
    "category": "security_misconfiguration",
    "rule_type": "regex",
    "patterns": [
      "DEBUG.*=.*True",
      "debug.*:.*true",
      "app\\.debug.*=.*True",
      "development.*mode.*true"
    ],
    "target_languages": ["python", "javascript"],
    "file_patterns": ["*.py", "*.js", "*.json", "*.yaml", "*.yml"],
    "excluded_paths": ["test", "tests", "development"],
    "case_sensitive": false,
    "multiline": false,
    "enabled": true,
    "confidence_threshold": 0.8,
    "metadata": {
      "cwe_id": "CWE-489",
      "owasp_category": "A05:2021 - Security Misconfiguration",
      "references": [
        "https://cwe.mitre.org/data/definitions/489.html"
      ],
      "tags": ["debug", "configuration", "production"],
      "author": "CODVUNS Team",
      "created_date": "2025-01-01",
      "last_updated": "2025-01-01"
    }
  },
  {
    "id": "CRYPTO_WEAK_001",
    "name": "Weak Cryptographic Algorithm",
    "description": "Detecta uso de algoritmos criptográficos fracos",
    "severity": "HIGH", 
    "category": "cryptography",
    "rule_type": "regex",
    "patterns": [
      "hashlib\\.md5",
      "hashlib\\.sha1",
      "Crypto\\.Hash\\.MD5",
      "CryptoJS\\.MD5",
      "algorithm.*['\"]DES['\"]",
      "algorithm.*['\"]RC4['\"]"
    ],
    "target_languages": ["python", "javascript"],
    "file_patterns": ["*.py", "*.js"],
    "excluded_paths": ["test", "tests"],
    "case_sensitive": false,
    "multiline": false,
    "enabled": true,
    "confidence_threshold": 0.9,
    "metadata": {
      "cwe_id": "CWE-327",
      "owasp_category": "A02:2021 - Cryptographic Failures",
      "references": [
        "https://cwe.mitre.org/data/definitions/327.html"
      ],
      "tags": ["cryptography", "hash", "weak", "algorithm"],
      "author": "CODVUNS Team", 
      "created_date": "2025-01-01",
      "last_updated": "2025-01-01"
    }
  },
  {
    "id": "INJECTION_CMD_001",
    "name": "Command Injection",
    "description": "Detecta potencial injeção de comandos do sistema",
    "severity": "CRITICAL",
    "category": "injection", 
    "rule_type": "regex",
    "patterns": [
      "os\\.system\\s*\\(.*\\+",
      "subprocess\\.call\\s*\\(.*\\+",
      "subprocess\\.run\\s*\\(.*\\+",
      "exec\\s*\\(.*\\+",
      "shell=True.*\\+",
      "cmd.*=.*input.*\\+.*command"
    ],
    "target_languages": ["python"],
    "file_patterns": ["*.py"],
    "excluded_paths": ["test", "tests"],
    "case_sensitive": false,
    "multiline": false,
    "enabled": true,
    "confidence_threshold": 0.7,
    "metadata": {
      "cwe_id": "CWE-78",
      "owasp_category": "A03:2021 - Injection",
      "references": [
        "https://cwe.mitre.org/data/definitions/78.html",
        "https://owasp.org/www-community/attacks/Command_Injection"
      ],
      "tags": ["command", "injection", "os", "subprocess"],
      "author": "CODVUNS Team",
      "created_date": "2025-01-01", 
      "last_updated": "2025-01-01"
    }
  }
]